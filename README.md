# StatisticWebApiService

Клиент-серверное приложение для учета количества посетителей в торговой точке, необходимые функции:
* регистрация магазинов в системе
* добавление статистики
* обнуление статистики

Задачи:
* провести ревью кода, обнаружить архитектурные ошибки. Замечания описывать как можно детальнее, писать в коде или отдельным списком, как удобнее
* провести исправление кода после ревью. Код отвечающий за добавление статистики должен быть асинхронный
* восстановить недостающий код
* написать тесты, 100% покрытие не требуется

Решение:

В задании использовался класс SemaphoreSlim для синхронизации асинхронных операций.
В отличие от классов Monitor, Mutex и ReaderWriterLock, класс Semaphore не поддерживает сходство потоков. 
Это означает, что его можно использовать в сценариях, в которых один поток получает семафор, а другой поток освобождает его.  

Замечания по оформлению:
1) Переименован DashboardStatProcessor в StatisticService.
2) Удалён файл PIngController.
3) ReviewMe переименован в ReviewMe.Web
4) HomeController: убраны лишние ковычки
5) HomeController: убран лишний непонятный Task.Delay(1000)
6) Удалён лишний код по инициализации в Application_Start
7) Переименование всех проектов на более соответсвуетствующие название.
8) Миграции не были подключены. Исправлено.
9) Исправлены везде неймспейсы.
10) Убрана лишняя коллекция _statisticData в DashboardStatProcessor
11) В методе HomeController/AddHumanVisitors убран недостижимый код
12) В контроллере возвращаемые значения приведены к общему типу
13) Интерфейс в клиенте переименован в IReviewMeWeb
14) Переименование методов в интерфейсе на клиенте

Замечания по архитектуре:
1) Отсутствует внедрение зависимостей. Добавил Unity контейнер.
2) Отсутствует работа с БД через репозитории и UnitOfWork. Добавлено.
3) Удален IAsyncLock / AsyncLock. Добавлена потокобезопасная реализация сервиса статистики (DashboardStatProcessor)
4) DashboardStatProcessor имеет статистические методы. Убраны.
5) Метод AddHumanVisitors убрано возвращающее значение, т.к. не соответсвует CQRS
6) В методе AddHumanVisitors добавил создание пользователя, если он отсутствует.
7) В методе GetVisitorsCount добавил учет отсутствия пользователя.
8) Тесты имеют рекомедуемый формат Arrange / Act / Assert
9) Добавлена обработка исключений на клиенте